<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ChronoVitesse ‚Äî EPS</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f7fafc; --fg:#0f172a; --muted:#64748b; --ring:#e2e8f0; --card:#ffffff;
    --primary:#2563eb; --green:#16a34a; --amber:#f59e0b; --red:#ef4444; --violet:#7c3aed; --cyan:#0891b2; --pink:#e11d48;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:"Inter",system-ui,ui-sans-serif,Segoe UI,Roboto,Arial,sans-serif;
    background:linear-gradient(180deg,#f8fafc 0%,#ffffff 60%); color:var(--fg); display:flex; flex-direction:column;
  }
  .container{max-width:1080px; margin:0 auto; padding:20px}
  .section{display:none} .section.active{display:block}
  .card{background:var(--card); border:1px solid var(--ring); border-radius:18px; padding:18px; box-shadow:0 10px 28px rgba(15,23,42,.06)}
  .stack{display:flex; flex-direction:column; gap:14px}
  .row{display:flex; flex-wrap:wrap; gap:12px; align-items:center}
  .tiles{display:grid; gap:16px; grid-template-columns:1fr} @media(min-width:720px){ .tiles{grid-template-columns:repeat(3,1fr)} }
  .tile{border-radius:18px; padding:18px; color:#fff; min-height:150px; display:flex; flex-direction:column; justify-content:space-between; box-shadow:0 14px 28px rgba(0,0,0,.10); cursor:pointer; transition:transform .08s ease, box-shadow .15s}
  .tile:hover{transform:translateY(-2px); box-shadow:0 18px 34px rgba(0,0,0,.14)}
  .t-green{background:linear-gradient(135deg,#16a34a,#22c55e)} .t-cyan{background:linear-gradient(135deg,#0891b2,#06b6d4)}
  .t-blue{background:linear-gradient(135deg,#2563eb,#3b82f6)} .t-violet{background:linear-gradient(135deg,#7c3aed,#8b5cf6)}
  .t-amber{background:linear-gradient(135deg,#f59e0b,#fbbf24)} .t-pink{background:linear-gradient(135deg,#e11d48,#fb7185)}
  h1.brand{font-size:clamp(42px,6vw,72px); font-weight:800; text-align:center; margin:30px 0 8px}
  .subtitle{text-align:center; color:var(--muted); margin:0 0 18px}
  .btn{appearance:none; border:none; cursor:pointer; font-weight:800; padding:14px 20px; border-radius:14px; background:var(--primary); color:#fff; font-size:1rem; box-shadow:0 10px 20px rgba(37,99,235,.22)}
  .btn.sec{background:#e2e8f0; color:#0f172a; box-shadow:none}
  .btn.ghost{background:transparent; border:1px solid var(--ring); color:var(--fg)}
  .btn.green{background:var(--green)} .btn.amber{background:var(--amber)} .btn.red{background:var(--red)} .btn.violet{background:var(--violet)} .btn.cyan{background:var(--cyan)}
  .btn.xl{font-size:18px; padding:16px 22px; border-radius:16px}
  .btn.circle{width:104px; height:104px; border-radius:999px; font-size:.95rem; display:flex; align-items:center; justify-content:center}
  label{font-weight:700; font-size:.95rem}
  input,select{width:100%; padding:12px 14px; border-radius:12px; border:1px solid var(--ring); background:#fff; font-size:1rem}
  table{width:100%; border-collapse:separate; border-spacing:0; border-radius:14px; overflow:hidden; border:1px solid var(--ring); background:#fff}
  th,td{padding:10px 12px; border-bottom:1px solid var(--ring); font-size:.96rem} th{background:#f1f5f9; text-align:left}
  tr:nth-child(even) td{background:#fbfdff}
  .dial-wrap{position:relative; width:300px; height:300px}
  .dial{width:300px; height:300px; display:block; transform:rotate(-90deg)}
  .dial-track{stroke:#e5e7eb; stroke-width:18; fill:none}
  .dial-progress{stroke:var(--primary); stroke-width:18; fill:none; stroke-linecap:round; transition:stroke-dashoffset .15s}
  .dial-center{position:absolute; inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:6px}
  .dial-time{font-variant-numeric:tabular-nums; font-size:52px; font-weight:900; letter-spacing:.5px; color:#0b4975}
  .dial-meta{font-size:.95rem; color:var(--muted); font-weight:700}
  .alert .dial-progress{stroke:var(--red)} .alert .dial-time{color:#7f1d1d}
  footer{margin-top:auto; text-align:center; padding:16px; background:#0f172a; color:#e2e8f0; font-weight:700}
</style>
<script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
</head>
<body>

<!-- ACCUEIL SIMPLE -->
<section id="home" class="section active">
  <div class="container">
    <h1 class="brand">ChronoVitesse</h1>
    <p class="subtitle">Outils chrono & tests pour l‚ÄôEPS ‚Äî simple, rapide, lisible.</p>
    <div class="stack" style="align-items:center">
      <button id="btn-start-app" class="btn xl green">D√©marrer</button>
    </div>
  </div>
</section>

<!-- CHOIX DES MODES -->
<section id="modes" class="section">
  <div class="container">
    <div class="row" style="justify-content:space-between">
      <h2 style="margin:0">Choisir un mode</h2>
      <button class="btn sec" onclick="nav('home')">‚Üê Accueil</button>
    </div>
    <div class="tiles" style="margin-top:14px">
      <div class="tile t-green" onclick="nav('timer')"><div>‚è±</div><div><h3>Minuteur</h3><p>D√©compte (mm:ss), gros cadran.</p></div></div>
      <div class="tile t-cyan" onclick="nav('simple')"><div>üïí</div><div><h3>Chrono simple</h3><p>Compteur ascendant.</p></div></div>
      <div class="tile t-blue" onclick="nav('help-laps')"><div>üèÅ</div><div><h3>Chrono avec tours</h3><p>√âl√®ve, tours, QR & CSV.</p></div></div>
      <div class="tile t-violet" onclick="nav('vma')"><div>üéØ</div><div><h3>Test VMA (navette)</h3><p>Paliers, vitesse, QR r√©sultat.</p></div></div>
      <div class="tile t-amber" onclick="nav('chase')"><div>üèÉ‚Äç‚ôÄÔ∏èüèÉ‚Äç‚ôÇÔ∏è</div><div><h3>Course poursuite</h3><p>Deux √©l√®ves, gagnant.</p></div></div>
      <div class="tile t-pink" onclick="nav('series')"><div>üìã</div><div><h3>S√©rie multi-√©preuves</h3><p>Encha√Ænez plusieurs chronos.</p></div></div>
    </div>
  </div>
</section>

<!-- AIDE LAPS -->
<section id="help-laps" class="section">
  <div class="container">
    <div class="row" style="justify-content:space-between"><h2 style="margin:0">Mode d‚Äôemploi ‚Äî Chrono avec tours</h2><button class="btn sec" onclick="nav('modes')">‚Üê Modes</button></div>
    <div class="card">
      <div class="stack">
        <p>1) Saisir <b>Nom / Pr√©nom / Classe / Sexe</b>, <b>Distance totale</b> et <b>Distance par tour</b>.</p>
        <p>2) D√©marrer ‚Üí bouton <b>Tour</b> √† chaque passage. Choisir <i>Temps du tour</i> ou <i>Temps cumul√©</i>.</p>
        <p>3) Arr√™t ‚Üí Tableau, QR ‚Äúinfos de course‚Äù, CSV simple/d√©taill√©.</p>
        <div><button class="btn violet" onclick="nav('form')">Saisie √©l√®ve ‚Üí</button></div>
      </div>
    </div>
  </div>
</section>

<!-- SAISIE LAPS -->
<section id="form" class="section">
  <div class="container">
    <div class="row" style="justify-content:space-between"><h2 style="margin:0">Saisie √©l√®ve</h2><button class="btn sec" onclick="nav('help-laps')">‚Üê Aide</button></div>
    <div class="card">
      <div class="row">
        <div class="stack" style="flex:1 1 240px"><label>Nom</label><input id="in-nom" placeholder="Martin"></div>
        <div class="stack" style="flex:1 1 240px"><label>Pr√©nom</label><input id="in-prenom" placeholder="Julie"></div>
        <div class="stack" style="flex:1 1 200px"><label>Classe</label><input id="in-classe" placeholder="4C"></div>
        <div class="stack" style="flex:1 1 160px">
          <label>Sexe</label>
          <select id="in-sexe"><option value="M">M</option><option value="F">F</option><option value="Autre">Autre</option></select>
        </div>
        <div class="stack" style="flex:1 1 180px"><label>Distance totale (m)</label><input id="in-total" type="number" value="800"></div>
        <div class="stack" style="flex:1 1 180px"><label>Distance par tour (m)</label><input id="in-lap" type="number" value="200"></div>
      </div>
      <div class="row" style="margin-top:10px"><button class="btn" id="to-race">Aller au chrono ‚Üí</button></div>
    </div>
  </div>
</section>

<!-- CHRONO LAPS -->
<section id="race" class="section">
  <div class="container">
    <div class="row" style="justify-content:space-between">
      <div><h2 style="margin:0">Chrono (Tours)</h2><div class="muted" id="race-student"></div></div>
      <div class="row">
        <label>Mode tours</label>
        <select id="mode-tours"><option value="lap">Temps du tour</option><option value="cum">Temps cumul√©</option></select>
        <button class="btn sec" onclick="nav('form')">‚Ü∫ changer √©l√®ve</button>
      </div>
    </div>
    <div class="card" style="margin-top:12px">
      <div class="stack" style="align-items:center">
        <div class="dial-wrap" id="dial-wrap-laps">
          <svg class="dial" viewBox="0 0 240 240"><circle class="dial-track" cx="120" cy="120" r="96"></circle><circle class="dial-progress" id="dial-progress-laps" cx="120" cy="120" r="96"></circle></svg>
          <div class="dial-center"><div id="timer-laps" class="dial-time">00:00.0</div><div class="dial-meta"><span id="meta-done">0</span>/<span id="meta-total">‚Äî</span> m</div></div>
        </div>
        <div class="row">
          <button id="start-laps" class="btn circle green">D√©marrer</button>
          <button id="lap" class="btn circle cyan">Tour</button>
          <button id="stop-laps" class="btn circle amber">Stop</button>
          <button id="reset-laps" class="btn circle red">R√©init.</button>
        </div>
      </div>
    </div>
    <div class="row" style="margin-top:12px; align-items:flex-start">
      <div class="card" style="flex:1 1 420px">
        <h3 style="margin:0 0 8px">Tableau des tours</h3>
        <table><thead><tr><th>#</th><th>Distance (m)</th><th>Temps tour</th><th>Temps cumul√©</th><th>Vitesse (km/h)</th></tr></thead><tbody id="laps-body"></tbody></table>
      </div>
      <div class="card" style="flex:1 1 320px">
        <h3 style="margin:0 0 8px">Exports & QR</h3>
        <div class="row">
          <div id="qrcode" class="card" style="border:1px dashed var(--ring); padding:8px"></div>
          <div class="stack" style="min-width:260px">
            <button id="qr-laps" class="btn violet">QR infos de course</button>
            <button id="csv-laps-simple" class="btn amber">CSV simple (1 ligne)</button>
            <button id="csv-laps-detail" class="btn amber">CSV d√©taill√© (par tour)</button>
            <button id="new-laps" class="btn ghost">Nouvelle course</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- MINUTEUR -->
<section id="timer" class="section">
  <div class="container">
    <div class="row" style="justify-content:space-between"><h2 style="margin:0">Minuteur</h2><button class="btn sec" onclick="nav('modes')">‚Üê Modes</button></div>
    <div class="card" style="margin-top:12px">
      <div class="stack" style="align-items:center">
        <div class="row">
          <div class="stack"><label>Minutes</label><input id="tm-min" type="number" min="0" value="3"></div>
          <div class="stack"><label>Secondes</label><input id="tm-sec" type="number" min="0" max="59" value="0"></div>
        </div>
        <div class="dial-wrap" id="dial-wrap-timer">
          <svg class="dial" viewBox="0 0 240 240"><circle class="dial-track" cx="120" cy="120" r="96"></circle><circle class="dial-progress" id="dial-progress-timer" cx="120" cy="120" r="96"></circle></svg>
          <div class="dial-center"><div id="timer-down" class="dial-time">03:00.0</div><div class="dial-meta">D√©compte</div></div>
        </div>
        <div class="row">
          <button id="tm-start" class="btn circle green">D√©marrer</button>
          <button id="tm-pause" class="btn circle amber">Pause</button>
          <button id="tm-reset" class="btn circle red">R√©init.</button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- CHRONO SIMPLE -->
<section id="simple" class="section">
  <div class="container">
    <div class="row" style="justify-content:space-between"><h2 style="margin:0">Chrono simple</h2><button class="btn sec" onclick="nav('modes')">‚Üê Modes</button></div>
    <div class="card" style="margin-top:12px">
      <div class="stack" style="align-items:center">
        <div class="dial-wrap" id="dial-wrap-simple">
          <svg class="dial" viewBox="0 0 240 240"><circle class="dial-track" cx="120" cy="120" r="96"></circle><circle class="dial-progress" id="dial-progress-simple" cx="120" cy="120" r="96"></circle></svg>
          <div class="dial-center"><div id="timer-up" class="dial-time">00:00.0</div><div class="dial-meta">Comptage</div></div>
        </div>
        <div class="row">
          <button id="sp-start" class="btn circle green">D√©marrer</button>
          <button id="sp-pause" class="btn circle amber">Pause</button>
          <button id="sp-reset" class="btn circle red">R√©init.</button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- TEST VMA -->
<section id="vma" class="section">
  <div class="container">
    <div class="row" style="justify-content:space-between"><h2 style="margin:0">Test VMA (navette)</h2><button class="btn sec" onclick="nav('modes')">‚Üê Modes</button></div>
    <div class="card" style="margin-top:12px">
      <div class="row">
        <div class="stack" style="flex:1 1 260px">
          <label>Nom</label><input id="vma-nom">
          <label>Pr√©nom</label><input id="vma-prenom">
          <label>Classe</label><input id="vma-classe">
          <label>Sexe</label><select id="vma-sexe"><option>M</option><option>F</option><option>Autre</option></select>
        </div>
        <div class="stack" style="flex:1 1 260px">
          <label>Palier initial</label><input id="vma-start" type="number" value="1" min="1">
          <label>Palier max (objectif)</label><input id="vma-max" type="number" value="20" min="1">
          <label>Dur√©e palier (s)</label><input id="vma-palier-sec" type="number" value="60" min="10">
          <label>Incr√©ment vitesse (km/h par palier)</label><input id="vma-inc" type="number" value="0.5" step="0.1">
        </div>
      </div>
      <div class="stack" style="align-items:center; margin-top:10px">
        <div class="dial-wrap" id="dial-wrap-vma">
          <svg class="dial" viewBox="0 0 240 240"><circle class="dial-track" cx="120" cy="120" r="96"></circle><circle class="dial-progress" id="dial-progress-vma" cx="120" cy="120" r="96"></circle></svg>
          <div class="dial-center"><div id="vma-timer" class="dial-time">00:00.0</div><div class="dial-meta">Palier <span id="vma-palier">1</span> ‚Äî <span id="vma-speed">8.0</span> km/h</div></div>
        </div>
        <div class="row">
          <button id="vma-start-btn" class="btn circle green">D√©marrer</button>
          <button id="vma-next" class="btn circle cyan">Palier +1</button>
          <button id="vma-stop" class="btn circle amber">Stop</button>
          <button id="vma-reset" class="btn circle red">R√©init.</button>
        </div>
      </div>
      <div class="row" style="margin-top:12px; align-items:flex-start">
        <div class="card" style="flex:1 1 420px">
          <h3 style="margin:0 0 8px">Historique des paliers</h3>
          <table><thead><tr><th>#</th><th>Palier</th><th>Vitesse</th><th>Dur√©e</th></tr></thead><tbody id="vma-body"></tbody></table>
        </div>
        <div class="card" style="flex:1 1 320px">
          <h3 style="margin:0 0 8px">QR Test VMA</h3>
          <div class="row">
            <div id="qrcode-vma" class="card" style="border:1px dashed var(--ring); padding:8px"></div>
            <button id="vma-qr" class="btn violet">QR VMA</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- COURSE POURSUITE -->
<section id="chase" class="section">
  <div class="container">
    <div class="row" style="justify-content:space-between"><h2 style="margin:0">Course poursuite (A vs B)</h2><button class="btn sec" onclick="nav('modes')">‚Üê Modes</button></div>
    <div class="card" style="margin-top:12px">
      <div class="row">
        <div class="stack" style="flex:1 1 260px"><h3 style="margin:2px 0">√âl√®ve A</h3><label>Nom</label><input id="chA-nom"><label>Pr√©nom</label><input id="chA-prenom"><label>Classe</label><input id="chA-classe"></div>
        <div class="stack" style="flex:1 1 260px"><h3 style="margin:2px 0">√âl√®ve B</h3><label>Nom</label><input id="chB-nom"><label>Pr√©nom</label><input id="chB-prenom"><label>Classe</label><input id="chB-classe"></div>
      </div>
      <div class="row">
        <div class="card stack" style="align-items:center; flex:1 1 420px">
          <div class="dial-wrap"><svg class="dial" viewBox="0 0 240 240"><circle class="dial-track" cx="120" cy="120" r="96"></circle><circle class="dial-progress" id="dial-chA" cx="120" cy="120" r="96"></circle></svg><div class="dial-center"><div id="chA-time" class="dial-time">00:00.0</div><div class="dial-meta">√âl√®ve A</div></div></div>
          <div class="row"><button id="chA-lap" class="btn cyan">Tour A</button></div>
          <table><thead><tr><th>#</th><th>Tour</th><th>Cumul√©</th></tr></thead><tbody id="chA-body"></tbody></table>
        </div>
        <div class="card stack" style="align-items:center; flex:1 1 420px">
          <div class="dial-wrap"><svg class="dial" viewBox="0 0 240 240"><circle class="dial-track" cx="120" cy="120" r="96"></circle><circle class="dial-progress" id="dial-chB" cx="120" cy="120" r="96"></circle></svg><div class="dial-center"><div id="chB-time" class="dial-time">00:00.0</div><div class="dial-meta">√âl√®ve B</div></div></div>
          <div class="row"><button id="chB-lap" class="btn cyan">Tour B</button></div>
          <table><thead><tr><th>#</th><th>Tour</th><th>Cumul√©</th></tr></thead><tbody id="chB-body"></tbody></table>
        </div>
      </div>
      <div c
