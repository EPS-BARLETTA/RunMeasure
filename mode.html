<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ChronoVitesse • Mode</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js" defer></script>
  <script src="modes.js" defer></script>
</head>
<body>
  <header class="topbar colorful">
    <h1 id="title">ChronoVitesse</h1>
  </header>

  <main class="container">
    <div class="nav-row">
      <a href="options.html" class="btn btn-outline">&larr; Retour</a>
      <a href="aide.html" class="btn btn-outline">Aide</a>
    </div>

    <section class="card">
      <h2 id="mode-name">Mode</h2>

      <div id="params" class="params grid-3"></div>

      <div class="timer">
        <div class="circle-wrap hidden" id="circle-wrap">
          <svg viewBox="0 0 120 120" class="circle">
            <circle cx="60" cy="60" r="54" class="bg"></circle>
            <circle cx="60" cy="60" r="54" class="fg" id="circle-fg"></circle>
            <text x="60" y="66" text-anchor="middle" class="circle-text" id="circle-text">00:00</text>
          </svg>
        </div>

        <div id="display" class="display">00:00.0</div>
        <div class="controls">
          <button id="btn-start" class="btn btn-primary btn-lg" type="button">Démarrer</button>
          <button id="btn-lap" class="btn btn-accent btn-lg" type="button" disabled>Tour</button>
          <button id="btn-stop" class="btn btn-amber btn-lg" type="button" disabled>Stop</button>
          <button id="btn-reset" class="btn btn-danger btn-lg" type="button" disabled>Reset</button>
        </div>

        <div id="live-distance" class="live-distance hidden">Distance cumulée : <span id="live-dist-val">0</span> m</div>
      </div>

      <div id="table-wrap" class="table-wrap hidden">
        <table id="laps-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Temps cumulé</th>
              <th>Temps tour</th>
              <th>Vitesse tour (km/h)</th>
            </tr>
          </thead>
          <tbody></tbody>
          <tfoot>
            <tr id="row-total" class="strong hidden">
              <td>Total</td>
              <td id="total-time">—</td>
              <td>—</td>
              <td id="total-speed">—</td>
            </tr>
          </tfoot>
        </table>
      </div>

      <div id="results" class="results hidden">
        <div id="fraction-tools" class="card info hidden" style="margin:0 0 1rem 0;">
          <strong>Ajouter une fraction de tour :</strong>
          <div class="fraction-row">
            <button class="btn btn-outline" data-frac="0.25">+ 1/4 tour</button>
            <button class="btn btn-outline" data-frac="0.5">+ 1/2 tour</button>
            <button class="btn btn-outline" data-frac="0.75">+ 3/4 tour</button>
            <button class="btn" id="btn-frac-undo">Annuler</button>
          </div>
          <small class="info">La distance totale et (si applicable) la VMA seront recalculées. Le QR sera regénéré.</small>
        </div>

        <div id="recap" class="card hidden">
          <h3>Récapitulatif</h3>
          <table class="recap-table">
            <tbody id="recap-body"></tbody>
          </table>
        </div>

        <div id="intervalles-export" class="card info hidden" style="margin:0 0 1rem 0;">
          <strong>Exporter en QR :</strong>
          <label style="display:block;margin-top:.5rem">
            <input type="radio" name="ivl-type" value="cumules" checked> Temps <em>cumulés</em> (t200, t400, …)
          </label>
          <label style="display:block;margin-top:.3rem">
            <input type="radio" name="ivl-type" value="intervalles"> Temps <em>à chaque intervalle</em> (200, 200, …)
          </label>
          <button id="btn-gen-qr" class="btn btn-primary" type="button" style="margin-top:.6rem">Générer le QR</button>
        </div>

        <div class="export-buttons">
          <div id="qrcode" class="qrcode"></div>
          <button id="btn-export-csv" class="btn btn-primary" type="button">Exporter CSV</button>
          <button id="btn-new" class="btn btn-danger" type="button">Recommencer</button>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    ChronoVitesse - Equipe EPS Lycée Vauban - LUXEMBOURG - JB
  </footer>
</body>
</html>
